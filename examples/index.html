<!DOCTYPE html>
<html>
<head>
    <title>Angular kodi module</title>
    <script type="text/javascript" src="../lib/angular/angular.min.js"></script>
    <script type="text/javascript" src="../lib/angular-md5/angular-md5.min.js"></script>
    <script type="text/javascript" src="../lib/angular-websocket-provider/dist/angular-websocket.min.js"></script>
    <!--<script type="text/javascript" src="../lib/angular-websocket-provider/dist/angular-websocket-log.min.js"></script>-->
    <script type="text/javascript" src="../lib/javascript-state-machine/state-machine.min.js"></script>
    <script type="text/javascript" src="../lib/lokijs/build/lokijs.min.js"></script>
    <script type="text/javascript" src="../src/core.js"></script>
    <script type="text/javascript" src="../src/cache.js"></script>
    <script type="text/javascript" src="../src/queue/request.js"></script>
    <script type="text/javascript" src="../src/validator/request.js"></script>
    <script type="text/javascript" src="../src/transport/connexion.js"></script>
    <script type="text/javascript" src="../src/model/server.js"></script>
    <script type="text/javascript" src="../src/model/loki.js"></script>
    <script type="text/javascript" src="../src/model/server-schema.js"></script>
    <script type="text/javascript" src="../src/model/request.js"></script>
    <script type="text/javascript" src="../src/model/response.js"></script>
    <!--<script type="text/javascript" src="../src/entity/album.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/artist.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/episode.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/genre.js"></script>-->
    <script type="text/javascript" src="../src/entity/movie.js"></script>
    <!--<script type="text/javascript" src="../src/entity/player.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/season.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/song.js"></script>-->
    <!--<script type="text/javascript" src="../src/entity/tvshow.js"></script>-->
    <script type="text/javascript" src="../src/service/server.js"></script>
    <script type="text/javascript" src="../src/service/request.js"></script>
    <script type="text/javascript" src="../src/service/response.js"></script>
    <script type="text/javascript" src="../src/service/album.js"></script>
    <script type="text/javascript" src="../src/service/artist.js"></script>
    <script type="text/javascript" src="../src/service/episode.js"></script>
    <script type="text/javascript" src="../src/service/genre.js"></script>
    <script type="text/javascript" src="../src/service/movie.js"></script>
    <script type="text/javascript" src="../src/service/player.js"></script>
    <script type="text/javascript" src="../src/service/season.js"></script>
    <script type="text/javascript" src="../src/service/song.js"></script>
    <script type="text/javascript" src="../src/service/tvshow.js"></script>
    <script type="application/javascript">
        var myApp = angular.module('myApp', ['kodi'])
                .config(['$websocketProvider',
                    function ($websocketProvider) {
                        // Configuration of the $websocketProvider
                        $websocketProvider.path = 'ws://localhost:9090';
                    }
                ])
                .controller('MyCtrl', function (kodiCore) {
                    kodiCore.onReady(function (kodiServer) {

                        console.info(kodiServer);

                        // TODO simplify the properties access with getter
                        kodiServer.VideoLibrary.GetMovies({properties:kodiServer.schema.types['Video.Fields.Movie'].items.enums}).then(
                            function (movies) {
                                console.log(movies);
                            },
                            function () {

                            },
                            function (notif) {
                                console.log(notif);
                            }
                        );

//                        TODO test cache request
//                        setTimeout(function(){
//                            kodi.VideoLibrary.GetMovies(null, {'hydrate': false}).then(
//                                function (movies) {
//                                    console.log('2', movies);
//                                    $scope.movie = movies;
//                                },
//                                function () {
//
//                                },
//                                function (p) {
//                                    console.log('2', p);
//                                }
//                            );
//                        }, 1000);
                    });
                });
    </script>
</head>
<body>
<div data-ng-app="myApp">
    <div data-ng-controller="MyCtrl">Open the console and refresh page to show the magic</div>
</div>
</body>
</html>